(()=>{var r=class{};var d=class extends r{_port;_disconnected=!1;_listeners=[];constructor(e){super(),this._port=e,e.onDisconnect.addListener(()=>{this._disconnected=!0})}onAny(e){let t=s=>{e(s.topic,s.args)};return this._port.onMessage.addListener(t),this._listeners.push(t),()=>{this._listeners.splice(this._listeners.indexOf(t),1),this._port.onMessage.removeListener(t)}}on(e,t){let s=n=>{n.topic===e&&t.apply(null,n.args)};return this._port.onMessage.addListener(s),this._listeners.push(s),()=>{this._listeners.splice(this._listeners.indexOf(s),1),this._port.onMessage.removeListener(s)}}once(e,t){let s=n=>{n.topic===e&&(t.apply(null,n.args),this._port.onMessage.removeListener(s))};this._port.onMessage.addListener(s)}emit(e,t){return this._disconnected?!1:(this._port.postMessage({topic:e,args:t,__ignore_ng_zone__:!0}),!0)}destroy(){this._listeners.forEach(e=>window.removeEventListener("message",e)),this._listeners=[]}};var o=class extends r{_source;_destination;_listeners=[];constructor(e,t){super(),this._source=e,this._destination=t}onAny(e){let t=s=>{s.source!==window||!s.data||!s.data.topic||s.data.source!==this._destination||e(s.data.topic,s.data.args)};return window.addEventListener("message",t),this._listeners.push(t),()=>{this._listeners.splice(this._listeners.indexOf(t),1),window.removeEventListener("message",t)}}on(e,t){let s=n=>{n.source!==window||!n.data||n.data.source!==this._destination||!n.data.topic||n.data.topic===e&&t.apply(null,n.data.args)};return window.addEventListener("message",s),this._listeners.push(s),()=>{this._listeners.splice(this._listeners.indexOf(s),1),window.removeEventListener("message",s)}}once(e,t){let s=n=>{n.source!==window||!n.data||n.data.source!==this._destination||!n.data.topic||(n.data.topic===e&&t.apply(null,n.data.args),window.removeEventListener("message",s))};window.addEventListener("message",s)}emit(e,t){return window.postMessage({source:this._source,topic:e,args:t,__ignore_ng_zone__:!0},"*"),!0}destroy(){this._listeners.forEach(e=>window.removeEventListener("message",e)),this._listeners=[]}};var h=!1,u=!1,c=!1,_=chrome.runtime.connect({name:`${document.title||location.href}`}),g=()=>{a.emit("shutdown"),a.destroy(),l.destroy(),h=!0};_.onDisconnect.addListener(g);var f=new o(`angular-devtools-content-script-${location.href}`,`angular-devtools-detect-angular-${location.href}`);f.on("detectAngular",i=>{if(u||i.isAngularDevTools!==!0||i.isAngular!==!0||document.contentType!=="text/html")return;let e=document.createElement("script");e.src=chrome.runtime.getURL("app/backend_bundle.js"),document.documentElement.appendChild(e),document.documentElement.removeChild(e),u=!0});var a=new o(`angular-devtools-content-script-${location.href}`,`angular-devtools-backend-${location.href}`),l=new d(_),w=()=>{a.emit("handshake")};l.onAny((i,e)=>{a.emit(i,e)});a.onAny((i,e)=>{c=!0,l.emit(i,e)});if(!c){console.log("Attempting initialization",new Date);let i=()=>{c||h||(w(),setTimeout(i,500))};i()}var m=i=>{if(i.source===window&&i.data)try{chrome.runtime.sendMessage(i.data)}catch(e){let{message:t}=e;throw t.includes("Extension context invalidated.")&&(console.error("Angular DevTools: Disconnecting content script due to invalid extension context. Please reload the page."),window.removeEventListener("message",m)),e}};window.addEventListener("message",m);})();
/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.dev/license
 */
//# sourceMappingURL=content_script_bundle.js.map
